<ion-header>
    <ion-navbar>
        <button ion-button menuToggle icon-only>
            <ion-icon name='menu'></ion-icon>
        </button>
        <ion-title>
            Group Element
        </ion-title>
    </ion-navbar>
</ion-header>

<ion-content padding>

    <h1>SVG Group Element</h1>

    <h2>4 SVG basic shape elements</h2>



    <textarea code-prism="html">
        <svg width="200" height="200" style="border:1px solid black;">
            <circle cx="20" cy="20" r="20" fill="green" />
            <circle cx="70" cy="70" r="20" fill="purple" />
            <rect x="110" y="110" height="30" width="30" fill="blue" />
            <rect x="160" y="160" height="30" width="30" fill="red" />
        </svg>
    </textarea>
    <svg width="200" height="200" style="border:1px solid black;">
        <circle cx="20" cy="20" r="20" fill="green" />
        <circle cx="70" cy="70" r="20" fill="purple" />
        <rect x="110" y="110" height="30" width="30" fill="blue" />
        <rect x="160" y="160" height="30" width="30" fill="red" />
    </svg>



<h2>Example of prismjs</h2>
    <textarea code-prism="javascript">
        import {ChangeDetectorRef, Directive, ElementRef, Renderer, Renderer2} from '@angular/core';
        import * as Prism from 'prismjs';

        @Directive({
            selector: 'textarea[code-prism]'
        })
        export class CodePrismDirective {

            el:any;
            content:string;
            language:string;

            constructor(public elementRef: ElementRef, public renderer: Renderer2, private changeDetector: ChangeDetectorRef) {
                console.log('Hello CodePrismDirective Directive');
            }

            ngOnInit(){
                this.content = this.elementRef.nativeElement.value;
                this.language = this.elementRef.nativeElement.getAttribute('code-prism');

                this.el = this.renderer.createElement('pre');
                this.renderer.appendChild(this.el, this.renderer.createText(this.content));
                // this.el.innerHTML = content;
                this.renderer.addClass(this.el, 'prism');
                this.renderer.addClass(this.el, 'language-' + this.language);
                this.renderer.setAttribute(this.el, 'data-prism-language', this.language);

                this.renderer.insertBefore(this.elementRef.nativeElement.parentElement, this.el, this.elementRef.nativeElement);

                this.elementRef.nativeElement.remove();

                this.highlightCode();
            }

            highlightCode():void {
                let newContent = '';
                let highlightedHTML = Prism.highlight(this.content, Prism.languages[this.language])
                    // .replace(/^\s\s*/, '') // delete spaces at the start of the block
                    .replace(/\s\s*$/, ''); // delete spaces at the end of the block

                let spacesToCancel = highlightedHTML.search(/\S|$/);

                let lines = highlightedHTML.split('\n');

                lines.forEach((line, index) => {
                    let spacesAtStart = line.search(/\S|$/);
                    if(spacesAtStart >= spacesToCancel) {
                        line = line.slice(spacesToCancel);
                    }
                    else {
                        line = line.slice(spacesAtStart);
                    }
                    newContent += line + '\n';
                });

                this.el.innerHTML = newContent;
            }
        }

    </textarea>


</ion-content>
